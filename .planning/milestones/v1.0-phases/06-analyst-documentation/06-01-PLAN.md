---
phase: 06-analyst-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/analyst-guide.qmd
  - docs/custom.scss
autonomous: false
requirements: [INFRA-03, INFRA-04]
must_haves:
  truths:
    - "Quarto is installed and on PATH"
    - "The weca-report typst extension is installed in the project"
    - "The .qmd file has valid YAML front matter with dual HTML+PDF output"
    - "The custom.scss file applies WECA brand colours to HTML output"
    - "quarto render docs/analyst-guide.qmd --to html produces an HTML file without errors"
  artefacts:
    - path: "docs/analyst-guide.qmd"
      provides: "Quarto document skeleton with YAML front matter and section headings"
      contains: "weca-report-typst"
    - path: "docs/custom.scss"
      provides: "WECA-branded SCSS theme for HTML output"
      contains: "#40A832"
    - path: "_extensions/weca-report/"
      provides: "Typst template extension for PDF output"
  key_links:
    - from: "docs/analyst-guide.qmd"
      to: "docs/custom.scss"
      via: "theme reference in YAML front matter"
      pattern: "theme:.*custom\\.scss"
    - from: "docs/analyst-guide.qmd"
      to: "_extensions/weca-report/"
      via: "weca-report-typst format in YAML"
      pattern: "weca-report-typst"
---

<objective>
Set up Quarto infrastructure and create the analyst guide skeleton with WECA branding.

Purpose: Establish the document authoring environment (Quarto + typst extension + SCSS branding) and create the .qmd file with valid dual-format YAML front matter and all section headings, ready for content authoring in Plan 02.

Output: A renderable .qmd skeleton with WECA-branded HTML and PDF output configured.
</objective>

<execution_context>
@C:/Users/steve.crawshaw/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/steve.crawshaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-analyst-documentation/06-RESEARCH.md
@.planning/phases/06-analyst-documentation/06-CONTEXT.md
@.planning/phases/05-refresh-pipeline-and-data-catalogue/05-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Quarto, typst extension, and create WECA-branded SCSS</name>
  <files>docs/custom.scss, _extensions/weca-report/</files>
  <action>
1. Install Quarto if not already on PATH:
   - Try `quarto --version` first
   - If missing, install via `winget install Posit.Quarto` (or download from https://quarto.org/docs/download/ if winget fails)
   - Verify with `quarto --version`

2. Install the WECA typst template extension:
   - From the project root: `quarto add stevecrawshaw/typst-template --no-prompt`
   - This creates `_extensions/weca-report/` with the template files
   - Verify the extension directory exists

3. Create `docs/custom.scss` with WECA brand colours from the /weca-branding skill:
   - Primary brand: West Green #40A832
   - Dark/headings: Forest Green #1D4F2B
   - Body text: #1F1F1F (WECA black)
   - Font: Trebuchet MS (primary), Open Sans (fallback), sans-serif
   - Title banner: Forest Green background, white text
   - Headings: Forest Green
   - Links: West Green
   - Callout tips: West Green border
   - Code block styling: light grey background, subtle border

Use the SCSS template from 06-RESEARCH.md Pattern 3 as the base, but expand it with proper code block styling and responsive typography.
  </action>
  <verify>
    <automated>quarto --version &amp;&amp; ls _extensions/weca-report/_extension.yml &amp;&amp; ls docs/custom.scss</automated>
    <manual>Verify custom.scss contains correct WECA hex values</manual>
  </verify>
  <done>Quarto installed, weca-report extension present in _extensions/, custom.scss created with WECA brand colours</done>
</task>

<task type="auto">
  <name>Task 2: Create analyst-guide.qmd skeleton with dual-format YAML and section structure</name>
  <files>docs/analyst-guide.qmd</files>
  <action>
Create `docs/analyst-guide.qmd` with:

1. YAML front matter (from 06-RESEARCH.md Pattern 1):
   - title: "WECA Data Platform: Analyst Guide"
   - subtitle: "Accessing shared datasets via pins and DuckLake"
   - author: "West of England Combined Authority"
   - date: last-modified
   - format.html: theme [default, custom.scss], toc true, toc-depth 3, code-fold false, embed-resources true
   - format.weca-report-typst: toc true, toc-depth 3
   - execute: echo true, eval false, warning false

2. Section headings following the linear tutorial structure from 06-RESEARCH.md Pattern 4:
   - `# Introduction` (what this guide covers, 10-minute promise)
   - `# Prerequisites and Setup` with subsections: R Packages, DuckDB Installation, AWS Credentials
   - `# Available Datasets` (quick reference table of all 18 datasets + views)
   - `# Accessing Data via Pins` with subsections: Creating a Board, Listing Datasets, Reading a Dataset, Accessing Metadata, Large Datasets
   - `# Querying the DuckLake Catalogue` with subsections: Installing Extensions, Attaching the Catalogue, Basic SQL Queries, Using Views, Querying the Data Catalogue, Time Travel
   - `# Working with Spatial Data` with subsections: Reading GeoParquet Pins, Converting to sf Objects, Setting CRS, Plotting a Quick Map
   - `# Troubleshooting` (dedicated section)
   - `# Support and Contact`
   - `# Appendix A: Python Equivalents` with subsections: Pins Access, DuckLake Queries, Spatial Data with geopandas
   - `# Appendix B: SQL Quick Reference`

3. Each section should have a brief placeholder comment (e.g. `<!-- Content: board creation, pin_list, pin_read examples -->`) indicating what content goes there. This makes Plan 02's authoring work clear.

4. Add the WECA logo to the HTML output:
   - Copy `C:\Users\steve.crawshaw\.claude\skills\weca-branding\weca_logo.jpg` to `docs/weca_logo.jpg`
   - Reference in YAML front matter or as an image in the title section
  </action>
  <verify>
    <automated>quarto render docs/analyst-guide.qmd --to html 2>&amp;1 | head -5</automated>
    <manual>Open docs/analyst-guide.html in browser and verify WECA branding (green headings, correct font)</manual>
  </verify>
  <done>analyst-guide.qmd renders to HTML without errors, shows WECA branding and all section headings</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify WECA-branded HTML output</name>
  <what-built>Quarto infrastructure: weca-report typst extension installed, WECA-branded SCSS theme, and analyst-guide.qmd skeleton with all section headings rendering to HTML with WECA branding.</what-built>
  <how-to-verify>
    1. Open docs/analyst-guide.html in your browser
    2. Verify: Green headings (Forest Green #1D4F2B), correct font (Trebuchet MS), WECA logo visible
    3. Verify: Table of contents shows all expected sections (Introduction through Appendix B)
    4. Optionally test PDF: `quarto render docs/analyst-guide.qmd --to weca-report-typst`
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
1. `quarto --version` returns a version >= 1.4
2. `_extensions/weca-report/_extension.yml` exists
3. `docs/custom.scss` contains WECA brand hex values (#40A832, #1D4F2B)
4. `docs/analyst-guide.qmd` has valid YAML front matter with both html and weca-report-typst formats
5. `quarto render docs/analyst-guide.qmd --to html` succeeds
6. HTML output shows WECA-branded styling
</verification>

<success_criteria>
- Quarto installed and functional
- WECA typst template extension installed in project
- analyst-guide.qmd skeleton renders to HTML with WECA branding
- All section headings present matching the agreed structure from CONTEXT.md
- Ready for Plan 02 to fill in content
</success_criteria>

<output>
After completion, create `.planning/phases/06-analyst-documentation/06-01-SUMMARY.md`
</output>
